#include <iostream>
#include <string>
#define SIZE 500
using namespace std;

struct Stack
{
	string stackArr[SIZE];
	int bottom = 0;
	int top = 0;
	bool check = true;

	int checkTheType(char current)
	{
		if (current == '(' || current == '[' || current == '{')
		{
			return 1;
		}
		else if (current == ')' || current == ']' || current == '}')
		{
			return 2;
		}
		else return 0;
	}

	void push(char current)
	{
		if (checkSize() != SIZE && checkTheType(current) == 1) // Добавить открывающую
		{
			stackArr[top] = current;
			top++;
		}
		else if (checkSize() != SIZE && checkTheType(current) == 2)
		{
			if (stackArr[top - 1] == "(" && current == ')')
			{
				pop();
			}
			else if (stackArr[top - 1] == "[" && current == ']')
			{
				pop();
			}
			else if (stackArr[top - 1] == "{" && current == '}')
			{
				pop();
			}
			else check = false;
		}
		else check = false;
	}

	void pop()
	{
		if (!empty()) top--;
		else cout << "Стек уже пустой. Удалять нечего!\n\n";
	}

	int checkSize()
	{
		return top;
	}

	bool empty()
	{
		return top == 0;
	}

	bool finalCheck()
	{
		return check;
	}
};

int main()
{
	setlocale(LC_ALL, "ru");
	Stack BracketsCheck;
	string current;

	cout << "Введите последовательность скобок: ";
	cin >> current;
	for (int i = 0; i < current.length(); i++)
	{
		BracketsCheck.push(current[i]);
	}

	if (BracketsCheck.finalCheck() && BracketsCheck.empty()) cout << "\nПоследовательность верна!\n";
	else cout << "\nПоследовательность ошибочна!\n";
}
